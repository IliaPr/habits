version: '3'

services:
  django:
    build:
      context: ./
      dockerfile: ./Docker/Django/Dockerfile
    ports:
      - "8000:8000"
    env_file: .env
    depends_on:
      - postgres
      - redis

  postgres:
    build:
      context: ./
      dockerfile: ./Docker/PostgreSQL/Dockerfile
    env_file: .env

  redis:
    build:
      context: ./
      dockerfile: ./Docker/Redis/Dockerfile

  celery:
    build:
      context: ./
      dockerfile: ./Docker/Celery/Dockerfile
    command: "celery -A config worker -l info --queues=fila1"  # Обновите эту строку
    depends_on:
      - django
      - redis
      - postgres
    restart: on-failure
    networks:
      - live


networks:
  live:
